```sql
-- Base: ecommerce de ejemplo
CREATE DATABASE IF NOT EXISTS demo_opt;
USE demo_opt;

-- Usuarios
CREATE TABLE users (
user_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
username VARCHAR(50) NOT NULL,
email VARCHAR(150) NOT NULL,
signup_date DATE NOT NULL,
country CHAR(2),
INDEX idx_users_email (email)
) ENGINE=InnoDB;

-- Direcciones (1:N users -> addresses)
CREATE TABLE addresses (
address_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
user_id BIGINT UNSIGNED NOT NULL,
line1 VARCHAR(200),
city VARCHAR(80),
postal VARCHAR(20),
region VARCHAR(80),
country CHAR(2),
INDEX idx_addr_user (user_id),
CONSTRAINT fk_addr_user
FOREIGN KEY (user_id) REFERENCES users(user_id)
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB;

-- Categor√≠as de producto
CREATE TABLE categories (
category_id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(80) NOT NULL
) ENGINE=InnoDB;

-- Productos
CREATE TABLE products (
product_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
sku VARCHAR(30) NOT NULL,
name VARCHAR(200),
category_id INT,
price DECIMAL(10,2),
weight_grams INT,
INDEX idx_products_sku (sku),
INDEX idx_products_cat (category_id),
CONSTRAINT fk_product_cat
FOREIGN KEY (category_id) REFERENCES categories(category_id)
ON UPDATE CASCADE
) ENGINE=InnoDB;

-- Pedidos (orders)
CREATE TABLE orders (
order_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
user_id BIGINT UNSIGNED NOT NULL,
order_date DATETIME,
status VARCHAR(30),
billing_address_id BIGINT UNSIGNED,
shipping_address_id BIGINT UNSIGNED,
total DECIMAL(12,2),
INDEX idx_orders_user_date (user_id, order_date),
CONSTRAINT fk_orders_user
FOREIGN KEY (user_id) REFERENCES users(user_id)
ON UPDATE CASCADE,
CONSTRAINT fk_orders_billing
FOREIGN KEY (billing_address_id) REFERENCES addresses(address_id)
ON UPDATE CASCADE,
CONSTRAINT fk_orders_shipping
FOREIGN KEY (shipping_address_id) REFERENCES addresses(address_id)
ON UPDATE CASCADE
) ENGINE=InnoDB;

-- Items de pedido
CREATE TABLE order_items (
order_item_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
order_id BIGINT UNSIGNED NOT NULL,
product_id BIGINT UNSIGNED NOT NULL,
qty INT,
price DECIMAL(10,2),
INDEX idx_items_order (order_id),
INDEX idx_items_product (product_id),
CONSTRAINT fk_item_order
FOREIGN KEY (order_id) REFERENCES orders(order_id)
ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT fk_item_product
FOREIGN KEY (product_id) REFERENCES products(product_id)
ON UPDATE CASCADE
) ENGINE=InnoDB;

-- Pagos
CREATE TABLE payments (
payment_id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
order_id BIGINT UNSIGNED NOT NULL,
paid_amount DECIMAL(12,2),
paid_at DATETIME,
method VARCHAR(30),
INDEX idx_pay_order (order_id),
CONSTRAINT fk_pay_order
FOREIGN KEY (order_id) REFERENCES orders(order_id)
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB;

```

```

